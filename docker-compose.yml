services:
  meshmonitor:
    # Option 1: Use pre-built image from GitHub Container Registry (recommended)
    image: ghcr.io/yeraze/meshmonitor:latest

    # Option 2: Build locally (comment out 'image' above and uncomment below for development)
    # build:
    #   context: .
    #   dockerfile: Dockerfile

    # Auto-Upgrade: To enable automatic upgrades through the UI, use:
    #   docker compose -f docker-compose.yml -f docker-compose.upgrade.yml up -d
    # See docs/configuration/auto-upgrade.md for details

    container_name: meshmonitor
    ports:
      - "8087:3001"
    restart: unless-stopped
    volumes:
      - ./meshmonitor-data:/data
    env_file: .env
    
    
      # OPTIONAL: Uncomment and configure for production deployments
      # See docs/configuration/production.md for full production setup guide

      # For production with HTTPS reverse proxy (nginx, Caddy, Traefik):
      # - NODE_ENV=production
      # - SESSION_SECRET=your-generated-secret-here  # Required in production
      # - TRUST_PROXY=true
      # - ALLOWED_ORIGINS=https://yourdomain.com

      # For production with direct HTTP (not recommended):
      # - NODE_ENV=production
      # - SESSION_SECRET=your-generated-secret-here  # Required in production
      # - COOKIE_SECURE=false

      # DISASTER RECOVERY: Restore from system backup
      # To restore from a backup on container startup, set RESTORE_FROM_BACKUP
      # to the backup directory name (e.g., 2025-11-08_151637)
      # Backups must be in /data/system-backups/ directory
      # See docs/operations/disaster-recovery.md for details
      # - RESTORE_FROM_BACKUP=2025-11-08_151637

# volumes:
#   meshmonitor-data:
#     driver: local
